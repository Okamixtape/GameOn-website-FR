---
/**
 * Layout Redesign - Optimisé pour performance
 * 
 * Différences vs Layout.astro :
 * - Pas de Header/Footer (intégrés dans pages)
 * - Preload Hero image
 * - Optimisations LCP
 */

interface Props {
  title: string;
  description?: string;
  image?: string;
  heroImage?: string; // Image Hero à preload
}

const {
  title,
  description = "Rejoignez PIXEL CLASH Championship 2026 : le championnat retro gaming qui célèbre les racines du jeu vidéo. Compétitions classiques, ambiance arcade, nostalgie garantie !",
  image = "/Logo.png",
  heroImage,
} = Astro.props;

const canonicalUrl = new URL(Astro.url.pathname, Astro.site).href;
const canonicalImageUrl = new URL(image, Astro.site).href;

// Import global styles
import '../styles/global.css';

// Import analytics
import GoogleAnalytics from '../components/GoogleAnalytics.astro';
import GoogleSearchConsole from '../components/GoogleSearchConsole.astro';
---
<!DOCTYPE html>
<html lang="fr">
<head>
  <!-- Meta basics -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content={description} />
  <title>{title} | PIXEL CLASH</title>
  
  <!-- Canonical URL -->
  <link rel="canonical" href={canonicalUrl} />
  
  <!-- OpenGraph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content={title} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={canonicalImageUrl} />
  <meta property="og:url" content={canonicalUrl} />
  <meta property="og:site_name" content="PIXEL CLASH Championship" />
  <meta property="og:locale" content="fr_FR" />
  
  <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={title} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={canonicalImageUrl} />
  
  <!-- Performance: Preload Critical Resources -->
  {heroImage && (
    <link 
      rel="preload" 
      as="image" 
      href={`${heroImage}&w=1200`}
      fetchpriority="high"
    />
  )}
  
  <!-- Performance: Preconnect to External Domains -->
  <link rel="preconnect" href="https://images.unsplash.com" crossorigin />
  <link rel="preconnect" href="https://www.googletagmanager.com" />
  <link rel="dns-prefetch" href="https://www.google-analytics.com" />
  
  <!-- Google Search Console -->
  <GoogleSearchConsole />
  
  <!-- Fonts preload -->
  <link rel="preload" href="/fonts/DM_Sans/DMSans-Regular.ttf" as="font" type="font/ttf" crossorigin />
  <link rel="preload" href="/fonts/DM_Sans/DMSans-Bold.ttf" as="font" type="font/ttf" crossorigin />
  
  <!-- Favicon -->
  <link rel="icon" type="image/png" href="/favicon.png" />
  
  <!-- Generator -->
  <meta name="generator" content={Astro.generator} />
  
  <!-- Slot for additional head content (Schema.org, etc.) -->
  <slot name="head" />
  
  <!-- Critical CSS Inline (Performance) -->
  <style is:inline>
    /* Critical Above-the-Fold CSS */
    *,*::before,*::after{box-sizing:border-box}body{margin:0;font-family:'DM Sans',system-ui,-apple-system,sans-serif;background-color:#0a0a1f;color:#fff;line-height:1.6}header{position:fixed;top:0;left:0;right:0;z-index:50;backdrop-filter:blur(12px);background-color:rgba(10,10,31,.8);border-bottom:1px solid rgba(0,243,255,.1)}.hero{position:relative;min-height:700px;display:flex;align-items:center;padding:5rem 0}.container{width:100%;max-width:1280px;margin:0 auto;padding:0 1rem}.gradient-text{background:linear-gradient(to right,#00f3ff,#ff00ff,#00f3ff);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}.text-neon-cyan{color:#00f3ff}.text-neon-magenta{color:#ff00ff}.btn-primary{display:inline-flex;align-items:center;gap:.5rem;padding:1.75rem 2rem;background:linear-gradient(to right,#ff00ff,#ff0080,#ff00ff);color:#fff;font-weight:700;border-radius:.5rem;text-decoration:none;transition:all .3s;box-shadow:0 20px 25px -5px rgba(255,0,255,.6)}.btn-primary:hover{box-shadow:0 25px 30px -5px rgba(255,0,255,.8)}.loading{opacity:0;animation:fadeIn .3s ease-in forwards}@keyframes fadeIn{to{opacity:1}}
  </style>
  
  <!-- Google Analytics -->
  <GoogleAnalytics />
</head>
<body class="font-sans antialiased">
  <slot />
</body>
</html>
